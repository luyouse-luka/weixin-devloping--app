<view class="set-manager-page">
  <view class="header">
    <text class="title">管理者设置</text>
    <text class="subtitle">设置后可以接收订单通知</text>
  </view>

  <view class="content">
    <!-- 当前状态 -->
    <view class="status-card">
      <view class="status-item">
        <text class="status-label">当前状态：</text>
        <text class="status-value {{isManager ? 'active' : ''}}">
          {{isManager ? '已设置为管理者' : '未设置'}}
        </text>
      </view>
      <view class="status-item" wx:if="{{managerOpenId}}">
        <text class="status-label">OpenID：</text>
        <text class="status-value small">{{managerOpenId}}</text>
        <view class="copy-btn" bindtap="copyOpenId" data-openid="{{managerOpenId}}">
          <text>复制</text>
        </view>
      </view>
      <view class="status-item">
        <text class="status-label">当前用户OpenID：</text>
        <text class="status-value small">{{currentUserOpenId || '未获取'}}</text>
        <view class="copy-btn" bindtap="copyOpenId" data-openid="{{currentUserOpenId}}" wx:if="{{currentUserOpenId}}">
          <text>复制</text>
        </view>
      </view>
    </view>

    <!-- 操作按钮 -->
    <view class="actions">
      <button 
        class="action-btn primary" 
        bindtap="setAsManager"
        disabled="{{loading || isManager}}"
      >
        <text wx:if="{{loading}}">获取中...</text>
        <text wx:else>设置为管理者</text>
      </button>

      <button 
        class="action-btn secondary" 
        bindtap="clearManager"
        wx:if="{{isManager}}"
      >
        清除设置
      </button>

      <button 
        class="action-btn view-orders" 
        bindtap="viewOrders"
        wx:if="{{isManager}}"
      >
        查看订单管理
      </button>
    </view>

    <!-- 说明 -->
    <view class="tips">
      <view class="tip-title">使用说明：</view>
      <view class="tip-item">1. 点击"设置为管理者"获取当前用户的openid</view>
      <view class="tip-item">2. 设置后，当有新订单时会收到订阅消息通知</view>
      <view class="tip-item">3. 需要在app.js中配置订阅消息模板ID</view>
      <view class="tip-item">4. 需要开通云开发并创建sendOrderNotification云函数</view>
    </view>
  </view>
</view>

